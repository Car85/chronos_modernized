name: Test deploy on AWS runner
on: 
   push: 
       branches: ['master']
jobs:
   start-deploy:
    runs-on: [self-hosted]
    steps:
    - name: Checkout
      uses: actions/checkout@v3
    - name: Cleanup old binaries
      run: |
          if [ -f files.txt ]; then sudo rm $(cat files.txt); fi
    - name: Fresh install
      run: |
          sudo python setup.py install
    - name: Start services
      run: |
          sudo systemctl daemon-reload
          sudo service chronos start
